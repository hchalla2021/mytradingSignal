# === PRODUCTION ENVIRONMENT - ZERODHA LIVE DATA ONLY ===
# Copy this file and rename to .env in the backend directory
# Update all values marked with [YOUR_...] with your actual credentials

# ════════════════════════════════════════════════════════════════════════════
# 🔴 ZERODHA API - LIVE DATA ONLY (NO DUMMY DATA)
# ════════════════════════════════════════════════════════════════════════════
ZERODHA_API_KEY=[YOUR_ZERODHA_API_KEY]
ZERODHA_API_SECRET=[YOUR_ZERODHA_API_SECRET]
ZERODHA_ACCESS_TOKEN=[YOUR_ZERODHA_ACCESS_TOKEN]

# ⚠️ IMPORTANT: Access Token expires daily at 4:00 PM IST
# Refresh it at 9:00-9:10 AM IST (before market open at 9:15 AM)
# Get fresh token from: https://kite.zerodha.com/
# Keep .env file SECURE - add to .gitignore

# ════════════════════════════════════════════════════════════════════════════
# 🗄️ REDIS CACHE - For High-Speed Data Caching
# ════════════════════════════════════════════════════════════════════════════
REDIS_URL=redis://127.0.0.1:6379
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=  # Leave empty if no password, or set strong password

# ════════════════════════════════════════════════════════════════════════════
# 🗂️ DATABASE - PostgreSQL (If using, else leave empty)
# ════════════════════════════════════════════════════════════════════════════
DATABASE_URL=postgresql://user:password@localhost:5432/trading_signals
DB_HOST=localhost
DB_PORT=5432
DB_NAME=trading_signals
DB_USER=postgres
DB_PASSWORD=[YOUR_POSTGRES_PASSWORD]

# ════════════════════════════════════════════════════════════════════════════
# 🚀 SERVER CONFIGURATION
# ════════════════════════════════════════════════════════════════════════════
PORT=8000
HOST=127.0.0.1  # Use localhost for security, Nginx will reverse proxy
ENVIRONMENT=production
DEBUG=False  # IMPORTANT: Disable debug in production
PYTHONUNBUFFERED=1

# ════════════════════════════════════════════════════════════════════════════
# 🔐 SECURITY - JWT & Auth
# ════════════════════════════════════════════════════════════════════════════
JWT_SECRET=[GENERATE_STRONG_32_CHAR_SECRET_KEY]
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# ════════════════════════════════════════════════════════════════════════════
# 📊 MARKET CONFIGURATION - IST (Indian Standard Time)
# ════════════════════════════════════════════════════════════════════════════
MARKET_OPEN=09:15
MARKET_CLOSE=15:30
MARKET_TIMEZONE=Asia/Kolkata
MARKET_PRE_OPEN=09:00
MARKET_POST_CLOSE=15:40

# ════════════════════════════════════════════════════════════════════════════
# 💾 CACHE STRATEGY - Smart Caching During Trading Hours
# ════════════════════════════════════════════════════════════════════════════
ENABLE_SMART_CACHE=true
CACHE_TTL_TRADING=0         # 0 seconds = No cache during 9:15-3:30 (live analysis)
CACHE_TTL_OFF_HOURS=60      # 60 seconds cache outside trading hours
CACHE_TTL_BACKUP=86400      # 24 hours backup cache for historical data
ENABLE_BACKUP_CACHE=true    # Keep last known data for display when market closed

# ════════════════════════════════════════════════════════════════════════════
# 🔌 WEBSOCKET & LIVE DATA
# ════════════════════════════════════════════════════════════════════════════
ENABLE_WEBSOCKET=true
WS_HOST=0.0.0.0  # Listen on all interfaces (Nginx will proxy)
WS_PORT=8000     # Same as main FastAPI port
WS_PATH=/ws
WS_MAX_CONNECTIONS=100
WS_HEARTBEAT_INTERVAL=30  # Send heartbeat every 30 seconds

# ════════════════════════════════════════════════════════════════════════════
# 📝 LOGGING
# ════════════════════════════════════════════════════════════════════════════
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FILE=/var/log/trading-backend.log
LOG_MAX_BYTES=10485760  # 10MB
LOG_BACKUP_COUNT=5

# ════════════════════════════════════════════════════════════════════════════
# 🔄 DATA SOURCES - Symbols to Monitor
# ════════════════════════════════════════════════════════════════════════════
MARKET_SYMBOLS=NIFTY,BANKNIFTY,SENSEX
NIFTY_TOKEN=256265225  # Zerodha token for NIFTY
BANKNIFTY_TOKEN=260105025  # Zerodha token for BANKNIFTY
SENSEX_TOKEN=256265225  # Zerodha token for SENSEX (BSE)

# ════════════════════════════════════════════════════════════════════════════
# ⚙️ ANALYSIS ENGINE - Feature Flags
# ════════════════════════════════════════════════════════════════════════════
ENABLE_TECHNICAL_ANALYSIS=true      # VWAP, EMA, Support/Resistance
ENABLE_ZONE_CONTROL=true            # Breakdown risk, Bounce probability
ENABLE_VOLUME_ANALYSIS=true         # Volume pulse, Green/Red ratio
ENABLE_TREND_ANALYSIS=true          # Higher-Low structure
ENABLE_CANDLE_ANALYSIS=true         # Candle intent, Patterns
ENABLE_MARKET_STRUCTURE=true        # Order Flow, FVG, Order Blocks
ENABLE_PIVOT_ANALYSIS=true          # Pivot Points, SuperTrend
ENABLE_ORB_ANALYSIS=true            # Opening Range Breakout
ENABLE_RSI_ANALYSIS=true            # RSI 60/40 Momentum
ENABLE_SMART_MONEY=true             # Institutional positioning
ENABLE_OI_MOMENTUM=true             # OI-based signals
ENABLE_PCR_ANALYSIS=true            # Put-Call Ratio

# ════════════════════════════════════════════════════════════════════════════
# 📈 TECHNICAL INDICATOR PARAMETERS
# ════════════════════════════════════════════════════════════════════════════
EMA_FAST=9
EMA_MEDIUM=21
EMA_SLOW=50
EMA_200=200
RSI_PERIOD=14
RSI_OVERBOUGHT=70
RSI_OVERSOLD=30
SUPERTREND_PERIOD=10
SUPERTREND_MULTIPLIER=3
VOLUME_SMA_PERIOD=20

# ════════════════════════════════════════════════════════════════════════════
# 🌐 CORS & SECURITY
# ════════════════════════════════════════════════════════════════════════════
CORS_ORIGINS=https://your-domain.com,https://www.your-domain.com
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,OPTIONS
CORS_ALLOW_HEADERS=Content-Type,Authorization

# ════════════════════════════════════════════════════════════════════════════
# 📬 EMAIL ALERTS (Optional - for notifications)
# ════════════════════════════════════════════════════════════════════════════
ENABLE_EMAIL_ALERTS=false
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=[YOUR_EMAIL]
SMTP_PASSWORD=[YOUR_APP_PASSWORD]
ALERT_EMAIL_FROM=[YOUR_EMAIL]
ALERT_EMAIL_TO=[YOUR_EMAIL]

# ════════════════════════════════════════════════════════════════════════════
# 🔔 TELEGRAM ALERTS (Optional - for notifications)
# ════════════════════════════════════════════════════════════════════════════
ENABLE_TELEGRAM_ALERTS=false
TELEGRAM_BOT_TOKEN=[YOUR_TELEGRAM_BOT_TOKEN]
TELEGRAM_CHAT_ID=[YOUR_TELEGRAM_CHAT_ID]

# ════════════════════════════════════════════════════════════════════════════
# 📊 PERFORMANCE TUNING
# ════════════════════════════════════════════════════════════════════════════
ANALYSIS_CACHE_ENABLED=true
ANALYSIS_CACHE_TTL=5  # Cache analysis for 5 seconds during trading
BATCH_ANALYSIS_ENABLED=true  # Batch process multiple symbols
MAX_CONCURRENT_REQUESTS=10
REQUEST_TIMEOUT=30  # seconds

# ════════════════════════════════════════════════════════════════════════════
# 🎯 TEST MODE (DISABLE IN PRODUCTION)
# ════════════════════════════════════════════════════════════════════════════
TESTING=false          # ⚠️ NEVER set to true in production
USE_DUMMY_DATA=false   # ⚠️ NEVER set to true in production
DEMO_MODE=false        # ⚠️ NEVER set to true in production

# ════════════════════════════════════════════════════════════════════════════
# 🚨 IMPORTANT REMINDERS FOR PRODUCTION
# ════════════════════════════════════════════════════════════════════════════

# 1. ZERODHA TOKEN REFRESH
#    - Access tokens expire daily at 4:00 PM IST
#    - Refresh at 9:00-9:10 AM IST every morning BEFORE 9:15 AM market open
#    - Get token from: https://kite.zerodha.com/ (your account page)
#    - Update ZERODHA_ACCESS_TOKEN in this file
#    - Restart backend: supervisorctl restart trading-backend

# 2. SECURITY
#    - Keep this file in .gitignore
#    - Never commit .env to GitHub
#    - Use strong JWT_SECRET (32+ characters, mix of letters/numbers/symbols)
#    - Use HTTPS only (SSL certificate via Let's Encrypt)

# 3. LIVE DATA VERIFICATION
#    - Verify NO test/dummy data in production
#    - All three flags above must be false: TESTING, USE_DUMMY_DATA, DEMO_MODE
#    - Cross-check: curl https://your-domain.com/api/health
#    - Should show zerodha_api: "connected" with REAL prices

# 4. MONITORING
#    - Keep logs: tail -f /var/log/trading-backend.out.log
#    - Monitor Redis: redis-cli INFO stats
#    - Watch memory usage: free -m && redis-cli INFO memory
#    - Check daily: supervisorctl status

# 5. BACKUP & DISASTER RECOVERY
#    - Back up this file in secure location
#    - Backup Redis data: daily
#    - Backup database: daily
#    - Test restore procedure: monthly

# ════════════════════════════════════════════════════════════════════════════
# Generated: 2024-02-18
# Version: MyDailyTradingSignals v1.0
# Deployment: DigitalOcean Production (14 Signals • All Sections Integrated)
# ════════════════════════════════════════════════════════════════════════════
